{
      "name": "mailDemo",
      "version": "1.0.1",
      "script": "var e_mail;\ntry{\n    e_mail= waylayUtil.getRawData(options, options.requiredProperties.to, \"e-mail\");    \n} catch(err){\n    console.log(err);\n}\n\n\nvar TO = e_mail || options.requiredProperties.to;\n\nif(options.globalSettings.MANDRILL_KEY === undefined || options.requiredProperties.message === undefined ||\n    options.requiredProperties.subject === undefined || options.requiredProperties.from === undefined || \n    TO === undefined){\n        send(new Error(\"Error missing properties\"));\n    }\nelse {\n    if(waylayUtil.validateEmail(TO) && waylayUtil.validateEmail(options.requiredProperties.from) ){\n        var parsedMessage = waylayUtil.evaluateData(options, options.requiredProperties.message);\n        var tagLine = \"\\n\\n\\n -------------------------------\\npowered by waylay.io\";\n        var message = {\n            key: options.globalSettings.MANDRILL_KEY,\n            message: {\n                text: parsedMessage + tagLine,\n                subject: options.requiredProperties.subject,\n                from_email: options.requiredProperties.from,\n                from_name: options.requiredProperties.from,\n                to: [\n                    {\n                        email: TO,\n                        name: TO,\n                        type: \"to\"\n                    }\n                ],\n                headers: {\n                    \"Reply-To\": options.requiredProperties.from\n                },\n            }\n        };\n              \n        var requestOptions = {\n          url: 'https://mandrillapp.com/api/1.0/messages/send.json\"',\n          json: message\n        };\n        \n        request.post(requestOptions, function (error, response, body) {\n          if (!error && response.statusCode == 200) {\n            console.log(body);\n            send();\n          }else{\n              send(new Error(\"Error \" + error + \" \" + body));\n          }\n        });\n    } else{\n        var message = \"Emails are not valid: to=\" + TO + \", from=\" + options.requiredProperties.from;\n        console.log(message);\n        //logger.error(message);\n        send(new Error(message));\n    }\n}\n\n      ",
      "metadata": {
        "author": "",
        "category": "Demo",
        "description": "Mandrill actuator, based on the REST api\n<h3>Input parameters</h3>\n<ul>\n<li>from</li>\n<li>to</li>\n<li>message</li>\n<li>subject</li>\n</ul>\nYou must provide <strong>MANDRILL_KEY</strong> in the profile settings\n",
        "documentationURL": "",
        "iconURL": "http://www.neq3hosting.com/blog/wp-content/uploads/2014/05/mandrill.jpg",
        "supportedStates": [],
        "requiredProperties": [
          "from",
          "to",
          "message",
          "subject"
        ],
        "requiredRawData": []
      }
    }
