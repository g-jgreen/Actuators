{
    "name": "sendTweet",
    "version": "1.1.1",
    "type": "actuator",
    "script": "var OAuthConsumerKey = options.globalSettings.TEST_OAuthConsumerKey;\nvar OAuthConsumerSecret = options.globalSettings.TEST_OAuthConsumerSecret;\nvar OAuthAccessToken = options.globalSettings.TEST_OAuthAccessToken;\nvar OAuthAccessTokenSecret = options.globalSettings.TEST_OAuthAccessTokenSecret;\nvar message = waylayUtil.evaluateData(options, options.requiredProperties.message);\n\nvar sendClient = new twitter({\n  consumer_key: OAuthConsumerKey,\n  consumer_secret: OAuthConsumerSecret,\n  access_token_key: OAuthAccessToken,\n  access_token_secret: OAuthAccessTokenSecret\n});\n\nvar tweetMessage = function(message){\n    try{\n        sendClient.post('statuses/update', message, function(error, tweet, response){\n        if(error) \n            throw error;\n        //logger.info(tweet);  // Tweet body. \n        //logger.info(response);  // Raw response object. \n        });\n    } catch(err){\n        logger.error(err);\n        send(new Error(err));\n    }\n}\n\ntry{\n    if(message !== undefined) {\n        if(Array.isArray(message)){\n            //logger.info(\"send : \" + message.join(\",\"));\n            __.each(message, function(m){\n                logger.info(\"tweet : \" + m);\n                var tweet = {\n                status:  m\n                };\n                tweetMessage(tweet);\n            });\n        } else {\n            var tweet = {\n                status:  message\n            };\n            logger.info(\"tweet single message: \" + message);\n            tweetMessage(tweet);\n        }\n        send();\n    } else {\n        send(new Error(\"Missing message\"));\n    }\n} catch(err){\n    send(new Error(err));\n}\n",
    "metadata": {
        "author": "",
        "category": "Social",
        "description": "Send tweets. \nMessage is pre-processed using waylayUtil.evaluateData package.\n\nYou will need to get API keys by registering your app\n",
        "iconURL": "https://raw.githubusercontent.com/waylayio/documentation/master/icons/tweet.png",
        "supportedStates": [],
        "requiredProperties": [
            "message"
        ],
        "requiredRawData": []
    }
}
